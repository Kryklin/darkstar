<div class="container">
  @if (!showResult) {
    <mat-card class="decrypt-card">
      <mat-card-header>
        <mat-card-title>Decrypt Data</mat-card-title>
        <mat-card-subtitle>Enter the encrypted data, reverse key, and password to decrypt your mnemonic phrase.</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <mat-stepper linear #stepper>
          <mat-step [stepControl]="firstFormGroup">
            <form [formGroup]="firstFormGroup">
              <ng-template matStepLabel>Enter Encrypted Data</ng-template>
              <mat-form-field appearance="fill" class="full-width">
                <mat-label>Encrypted Data</mat-label>
                <textarea matInput formControlName="encryptedData" cdkTextareaAutosize cdkAutosizeMinRows="3" placeholder="Paste the encrypted data here"></textarea>
                @if (firstFormGroup.controls['encryptedData'].hasError('required')) {
                  <mat-error>Encrypted data is required.</mat-error>
                }
              </mat-form-field>
              <div class="stepper-buttons">
                <button mat-button matStepperNext>Next</button>
              </div>
            </form>
          </mat-step>
          <mat-step [stepControl]="secondFormGroup">
            <form [formGroup]="secondFormGroup">
              <ng-template matStepLabel>Enter Reverse Key</ng-template>
              <mat-form-field appearance="fill" class="full-width">
                <mat-label>Reverse Key</mat-label>
                <textarea matInput formControlName="reverseKey" cdkTextareaAutosize cdkAutosizeMinRows="2" placeholder="Paste the reverse key here"></textarea>
                @if (secondFormGroup.controls['reverseKey'].hasError('required')) {
                  <mat-error>Reverse key is required.</mat-error>
                }
              </mat-form-field>
              <div class="stepper-buttons">
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext>Next</button>
              </div>
            </form>
          </mat-step>
          <mat-step [stepControl]="thirdFormGroup">
            <form [formGroup]="thirdFormGroup">
              <ng-template matStepLabel>Enter Password</ng-template>
              <mat-form-field appearance="fill" class="full-width">
                <mat-label>Password</mat-label>
                <input matInput formControlName="password" type="password" placeholder="Enter your password">
                @if (thirdFormGroup.controls['password'].hasError('required')) {
                  <mat-error>Password is required.</mat-error>
                }
              </mat-form-field>
              <div class="stepper-buttons">
                <button mat-button matStepperPrevious>Back</button>
                <button mat-raised-button color="primary" (click)="onSubmit()">Decrypt</button>
              </div>
            </form>
          </mat-step>
        </mat-stepper>
      </mat-card-content>
      <mat-card-footer>
        <p class="footer-text">Decryption is performed locally in your browser. Your private data is never transmitted.</p>
      </mat-card-footer>
    </mat-card>
  } @else {
    <mat-card class="result-card">
      <mat-card-header>
        @if (error) {
          <mat-card-title class="error-title">Decryption Failed</mat-card-title>
        } @else {
          <mat-card-title>Decryption Successful</mat-card-title>
        }
      </mat-card-header>
      <mat-card-content>
        @if (error) {
          <div class="error-content">
            <p>{{ error }}</p>
          </div>
        } @else {
          <div class="result-content">
            <p><strong>Decrypted Mnemonic:</strong></p>
            <p class="mnemonic-phrase">{{ decryptedMnemonic }}</p>
          </div>
        }
      </mat-card-content>
      <mat-card-actions class="result-actions">
        <button mat-button (click)="reset()">Reset</button>
      </mat-card-actions>
    </mat-card>
  }
</div>

